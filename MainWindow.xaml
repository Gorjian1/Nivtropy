<Window x:Class="Nivtropy.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Nivtropy.ViewModels"
        xmlns:local="clr-namespace:Nivtropy"
        mc:Ignorable="d"
        Title="Nivtropy" Height="720" Width="1180">
    <DockPanel>
        <TabControl DockPanel.Dock="Top"
                    Margin="0"
                    SelectedValuePath="Tag"
                    SelectedValue="{Binding SelectedTab, Mode=TwoWay}">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem" BasedOn="{StaticResource RibbonTabHeaderStyle}" />
            </TabControl.ItemContainerStyle>

            <TabItem Header="Главная" Tag="{x:Static vm:RibbonTab.Main}">
                <ToolBarTray>
                    <ToolBar>
                        <Button Content="Открыть файл"
                                Command="{Binding OpenFileCommand}" />
                        <Separator />
                        <Button Content="Обновить"
                                Command="{Binding RefreshCommand}" />
                        <Button Content="Экспорт CSV"
                                Command="{Binding ExportCsvCommand}" />
                    </ToolBar>
                    <ToolBar>
                        <Label Content="Ход:" />
                        <ComboBox Width="240"
                                  ItemsSource="{Binding DataViewModel.Runs}"
                                  SelectedItem="{Binding SelectedRun, Mode=TwoWay}"
                                  DisplayMemberPath="Header" />
                        <Separator />
                        <Button Content="Проверка допуска"
                                Command="{Binding CheckToleranceCommand}" />
                    </ToolBar>
                </ToolBarTray>
            </TabItem>

            <TabItem Header="Расчёты" Tag="{x:Static vm:RibbonTab.Calculations}">
                <ToolBarTray>
                    <ToolBar>
                        <Label Content="Ход:" />
                        <ComboBox Width="240"
                                  ItemsSource="{Binding DataViewModel.Runs}"
                                  SelectedItem="{Binding SelectedRun, Mode=TwoWay}"
                                  DisplayMemberPath="Header" />
                        <Separator />
                        <Button Content="Обновить расчёт"
                                Command="{Binding RefreshCommand}" />
                        <Button Content="Проверка BF/FB"
                                Command="{Binding CheckToleranceCommand}" />
                    </ToolBar>
                </ToolBarTray>
            </TabItem>

            <TabItem Header="Проектирование" Tag="{x:Static vm:RibbonTab.Design}">
                <ToolBarTray>
                    <ToolBar>
                        <Label Content="Ход:" />
                        <ComboBox Width="240"
                                  ItemsSource="{Binding DataViewModel.Runs}"
                                  SelectedItem="{Binding SelectedRun, Mode=TwoWay}"
                                  DisplayMemberPath="Header" />
                        <Separator />
                        <Button Content="Сбросить проект"
                                Command="{Binding DesignViewModel.ResetCommand}" />
                    </ToolBar>
                </ToolBarTray>
            </TabItem>
        </TabControl>

        <ContentControl Content="{Binding CurrentView}" />
    </DockPanel>
</Window>
