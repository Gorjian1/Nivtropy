<Window x:Class="Nivtropy.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Nivtropy" Height="720" Width="1180">
    <DockPanel>
        <TabControl DockPanel.Dock="Top"
                    Margin="0"
                    SelectedIndex="{Binding SelectedRibbonIndex, Mode=TwoWay}">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem" BasedOn="{StaticResource RibbonTabHeaderStyle}" />
            </TabControl.ItemContainerStyle>

            <TabItem Header="Главная">
                <ToolBarTray>
                    <ToolBar>
                        <Button Content="Открыть файл" Command="{Binding OpenFileCommand}" />
                        <Separator />
                        <Button Content="Обновить" Command="{Binding RefreshCommand}" />
                        <Button Content="Экспорт CSV" Command="{Binding ExportCsvCommand}" />
                    </ToolBar>
                    <ToolBar>
                        <Label Content="Ход:" />
                        <ComboBox Width="240"
                                  ItemsSource="{Binding DataViewModel.Runs}"
                                  SelectedItem="{Binding SelectedRun}"
                                  DisplayMemberPath="Header"
                                  ToolTipService.ShowDuration="20000" />
                        <Separator />
                        <Button Content="Проверка допуска" Command="{Binding CheckToleranceCommand}" />
                    </ToolBar>
                </ToolBarTray>
            </TabItem>

            <TabItem Header="Расчёты">
                <ToolBarTray>
                    <ToolBar>
                        <Button Content="Добавить станцию" Command="{Binding CalculationViewModel.AddRowCommand}" />
                        <Button Content="Удалить" Command="{Binding CalculationViewModel.RemoveSelectedCommand}" />
                        <Separator />
                        <Button Content="Очистить" Command="{Binding CalculationViewModel.ClearCommand}" />
                        <Separator />
                        <Button Content="Рассчитать" Command="{Binding CalculationViewModel.CalculateCommand}" />
                        <Separator />
                        <Button Content="Из таблицы" Command="{Binding ImportTraverseFromDataCommand}" />
                    </ToolBar>
                </ToolBarTray>
            </TabItem>

            <TabItem Header="Проектирование">
                <ToolBarTray>
                    <ToolBar>
                        <Button Content="Рассчитать" Command="{Binding DesignViewModel.ComputeCommand}" />
                        <Separator />
                        <Button Content="Перенести из расчёта" Command="{Binding PushCalculationToDesignCommand}" />
                    </ToolBar>
                </ToolBarTray>
            </TabItem>
        </TabControl>

        <ContentControl Content="{Binding CurrentView}" />
    </DockPanel>
</Window>
